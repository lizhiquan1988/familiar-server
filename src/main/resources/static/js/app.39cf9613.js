(function(){"use strict";var t={1101:function(t,o,n){var e=n(9242),i=n(3396);const a=(0,i._)("p",null,"子供の見守り",-1);function r(t,o,n,e,r,c){const s=(0,i.up)("MapboxMap");return(0,i.wg)(),(0,i.iD)(i.HY,null,[a,(0,i.Wm)(s)],64)}var c=n(7139);const s=t=>((0,i.dD)("data-v-38c648dc"),t=t(),(0,i.Cn)(),t),l={class:"text-container"},d=s((()=>(0,i._)("p",null,"子供位置関連操作",-1))),u={key:0},h=s((()=>(0,i._)("div",{class:"text-commend"},"*1秒毎に最新位置を取得できます。",-1))),p={key:1},g={key:0,class:"text-container"},m={key:1,class:"text-container"},f=s((()=>(0,i._)("div",{id:"map"},null,-1)));function v(t,o,n,e,a,r){return(0,i.wg)(),(0,i.iD)("main",null,[(0,i._)("div",l,[d,0===a.updatingFlag?((0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("div",{class:"button",onClick:o[0]||(o[0]=(...t)=>r.getChildLocationAuto&&r.getChildLocationAuto(...t))},"自動更新"),h])):(0,i.kq)("",!0),0!==a.updatingFlag?((0,i.wg)(),(0,i.iD)("div",p,[(0,i._)("div",{class:"button_margin",onClick:o[1]||(o[1]=(...t)=>r.stopUpdateChildLocation&&r.stopUpdateChildLocation(...t))},"自動更新中止"),a.trackChildLocationFlag?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"button_margin",onClick:o[2]||(o[2]=(...t)=>r.stopTrackChildLocation&&r.stopTrackChildLocation(...t))},"追跡中止")):((0,i.wg)(),(0,i.iD)("div",{key:1,class:"button_margin",onClick:o[3]||(o[3]=(...t)=>r.trackChildLocation&&r.trackChildLocation(...t))},"追跡再開"))])):(0,i.kq)("",!0)]),0===a.distanceMeter?((0,i.wg)(),(0,i.iD)("div",g,"お子様が隣にいます。")):((0,i.wg)(),(0,i.iD)("div",m,"お子様との距離："+(0,c.zw)(a.distanceMeter),1)),f])}var C=n(7709),L=n.n(C),w=n(4018),b=n.n(w),k=n(4161),y=k.Z.create({baseURL:"https://120.27.140.127/",headers:{"Content-type":"application/json","Access-Control-Allow-Origin":"https://120.27.140.127","Access-Control-Allow-Methods":"POST, PUT, PATCH, GET, DELETE, OPTIONS","Access-Control-Allow-Headers":"*"}});class x{getAll(){return y.get("/location")}findByUserId(t){return y.get(`/location?userId=${t}&lastFlag=1`)}}var M,T,F=new x;L().supported()?console.log("Your browser supported Mapbox GL"):alert("Your browser does not support Mapbox GL");var D={name:"MapboxMap",data(){return{center:[139.7575,35.6789],location:[139.7575,35.6789],zoom:15,nowChildLat:0,nowChildLon:0,distanceMeter:0,updatingFlag:0,trackChildLocationFlag:!0}},mounted(){this.createMap(),this.addCurrentLocation(),this.addNavigationControl()},methods:{createMap(){this.map=new(L().Map)({accessToken:"pk.eyJ1IjoibWFwYm94bGl6aGlxdWFuIiwiYSI6ImNsZWZkejFyZzA0cTIzeHQxMTYzd2hrcjIifQ.GB7FcwHXN4gjp98WboK-1g",container:"map",style:"mapbox://styles/mapbox/streets-v11",minzoom:5,center:this.center,zoom:this.zoom,hash:!0}),this.map.addControl(new(b())({defaultLanguage:"ja"})),this.map.on("move",(()=>{this.center=this.map.getCenter()})),this.map.on("zoom",(()=>{this.zoom=this.map.getZoom()})),this.map.on("load",(()=>{}))},Toast(t,o){o=isNaN(o)?3e3:o;var n=document.createElement("div");n.innerHTML=t,n.style.cssText="font-size: .32rem;color: rgb(255, 255, 255);background-color: rgba(0, 0, 0, 0.6);padding: 10px 15px;margin: 0 0 0 -60px;border-radius: 4px;position: fixed;    top: 50%;left: 50%;width: 130px;text-align: center;",document.body.appendChild(n),setTimeout((function(){var t=.5;n.style.opacity="0",setTimeout((function(){document.body.removeChild(n)}),1e3*t)}),o)},addCurrentLocation(){let t=new(L().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},showAccuracyCircle:!0,showUserHeading:!0,showUserLocation:!0,trackUserLocation:!0});this.map.addControl(t),this.map.on("load",(()=>{t.trigger()})),t.on("geolocate",(t=>{const o=t.coords;this.location=[o.longitude,o.latitude],this.getLocationFromDB(),console.log("Your current position is:"),console.log(`Latitude : ${o.latitude}`),console.log(`Longitude: ${o.longitude}`),console.log(`More or less ${o.accuracy} meters.`)}))},addNavigationControl(){let t=new(L().NavigationControl)({visuaiizePitch:!0});this.map.addControl(t,"top-right")},addMarker(t,o){M=new(L().Marker)({color:"#FF7F50"}).setLngLat([t,o]).addTo(this.map),console.log("マーカー追加された"),this.trackChildLocationFlag&&this.moveToCenter(t,o),this.getDistance(t,o)},getChildLocationAuto(){this.getLocationFromDB(),T=setInterval(this.getLocationFromDB,1e3),this.updatingFlag=1},stopUpdateChildLocation(){clearInterval(T),this.updatingFlag=0},moveToCenter(t,o){this.map.flyTo({center:[t,o],zoom:this.zoom})},getDistance(t,o){const n=new(L().LngLat)(t,o),e=new(L().LngLat)(this.location[0],this.location[1]);this.distanceMeter=this.formatDistance(e.distanceTo(n))},stopTrackChildLocation(){this.trackChildLocationFlag=!1},trackChildLocation(){this.trackChildLocationFlag=!0},formatDistance(t){if(t=Math.trunc(t),0===t)return 0;if(t/1e3<=0)return t+"m";{const o=Math.floor(t/1e3),n=t-1e3*o,e=0===o?0:o+"Km ",i=0===n?0:n+"m";return 0===e&&0===i?0:(0===o?"":o+"Km ")+(0===n?"":n+"m")}},getLocationFromDB(){F.findByUserId("1001").then((t=>{var o=t.data;if(!(o.size<=0)){var n=o[0];M&&M.remove(),this.nowChildLon=n.longitude,this.nowChildLat=n.latitude,this.addMarker(this.nowChildLon,this.nowChildLat)}})).catch((t=>{console.log(t)}))}}},O=n(89);const _=(0,O.Z)(D,[["render",v],["__scopeId","data-v-38c648dc"]]);var z=_,A={name:"App",components:{MapboxMap:z}};const I=(0,O.Z)(A,[["render",r]]);var j=I;(0,e.ri)(j).mount("#app")}},o={};function n(e){var i=o[e];if(void 0!==i)return i.exports;var a=o[e]={exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,function(){var t=[];n.O=function(o,e,i,a){if(!e){var r=1/0;for(d=0;d<t.length;d++){e=t[d][0],i=t[d][1],a=t[d][2];for(var c=!0,s=0;s<e.length;s++)(!1&a||r>=a)&&Object.keys(n.O).every((function(t){return n.O[t](e[s])}))?e.splice(s--,1):(c=!1,a<r&&(r=a));if(c){t.splice(d--,1);var l=i();void 0!==l&&(o=l)}}return o}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[e,i,a]}}(),function(){n.n=function(t){var o=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(o,{a:o}),o}}(),function(){n.d=function(t,o){for(var e in o)n.o(o,e)&&!n.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:o[e]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)}}(),function(){var t={143:0};n.O.j=function(o){return 0===t[o]};var o=function(o,e){var i,a,r=e[0],c=e[1],s=e[2],l=0;if(r.some((function(o){return 0!==t[o]}))){for(i in c)n.o(c,i)&&(n.m[i]=c[i]);if(s)var d=s(n)}for(o&&o(e);l<r.length;l++)a=r[l],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(d)},e=self["webpackChunkfamiliar_server"]=self["webpackChunkfamiliar_server"]||[];e.forEach(o.bind(null,0)),e.push=o.bind(null,e.push.bind(e))}();var e=n.O(void 0,[998],(function(){return n(1101)}));e=n.O(e)})();
//# sourceMappingURL=app.39cf9613.js.map